# =============================================================================
# POIROT DSPM - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# All notification channels are enabled by default so you can configure
# them from the dashboard UI. They won't fire until you provide valid
# credentials (webhook URL, SMTP password, API key, etc.).
# =============================================================================

# =============================================================================
# NOTIFICATION CHANNELS
# =============================================================================

## Slack
SLACK_ENABLED=true
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_SEVERITY_FILTER=CRITICAL,HIGH,MEDIUM,LOW

## Microsoft Teams
TEAMS_ENABLED=true
TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/YOUR/WEBHOOK/URL
TEAMS_SEVERITY_FILTER=CRITICAL,HIGH,MEDIUM,LOW

## Generic Webhook
WEBHOOK_ENABLED=true
WEBHOOK_URL=https://example.com/webhook
WEBHOOK_METHOD=POST
WEBHOOK_HEADERS={}
WEBHOOK_SEVERITY_FILTER=CRITICAL,HIGH,MEDIUM,LOW

## SMTP Email
SMTP_ENABLED=true
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USE_TLS=true
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM_ADDRESS=alerts@yourcompany.com
SMTP_FROM_NAME="Poirot DSPM"
SMTP_TO_ADDRESSES=security@yourcompany.com,admin@yourcompany.com
SMTP_SEVERITY_FILTER=CRITICAL,HIGH,MEDIUM,LOW
SMTP_EMAIL_THEME=dark_cyber

## TheHive (Case Management)
THEHIVE_ENABLED=true
THEHIVE_URL=http://thehive:9000
THEHIVE_API_KEY=your-api-key-here
THEHIVE_USER=api@poirot.local
THEHIVE_PASSWORD=your-password
THEHIVE_CREATE_CASES=true
THEHIVE_SEVERITY_FILTER=CRITICAL,HIGH,MEDIUM,LOW

# =============================================================================
# AI-POWERED REPORTS (Optional)
# =============================================================================

## Ollama
OLLAMA_ENABLED=true
OLLAMA_URL=http://host.docker.internal:11434
OLLAMA_MODEL=llama3.1:latest
OLLAMA_SEVERITY_FILTER=CRITICAL,HIGH,MEDIUM,LOW

# =============================================================================
# DATA SOURCES (.env is the single source of truth)
# Format: SOURCE_{TYPE}_{NAME}={"field":"value",...}
# The name segment uses underscores (e.g. POC_MYSQL â†’ name "poc_mysql")
# =============================================================================

## MySQL example (connects to demo hawk-mysql container)
SOURCE_MYSQL_POC_MYSQL={"host":"hawk-mysql","port":3306,"user":"root","password":"rootpassword","database":"pocdb"}

## S3/LocalStack example (connects to demo localstack container)
SOURCE_S3_POC_BUCKET={"access_key":"test","secret_key":"test","bucket_name":"poc-bucket","endpoint_url":"http://localstack:4566"}

## Kafka/Redpanda example (connects to demo redpanda container)
SOURCE_KAFKA_DEMO={"bootstrap_servers":"redpanda:9092","topics":"transactions,employee_data,app_logs","max_messages":"500","group_id":"poirot-scanner"}

## Oracle example
# SOURCE_ORACLE_PROD={"host":"oracle.internal","port":1521,"service_name":"ORCL","user":"scanner","password":"s3cr3t","schema":"APP_SCHEMA","limit_rows":5000}

# =============================================================================
# SCHEDULER (Optional - for automatic scans)
# =============================================================================

SCHEDULER_ENABLED=true
SCHEDULER_INTERVAL_HOURS=24
