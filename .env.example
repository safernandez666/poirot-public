# =============================================================================
# POIROT DSPM - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# All notification channels are disabled by default.
# Enable only what you need.
# =============================================================================

# =============================================================================
# NOTIFICATION CHANNELS
# =============================================================================

## Slack
SLACK_ENABLED=false
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_SEVERITY_FILTER=CRITICAL,HIGH,MEDIUM,LOW

## Microsoft Teams
TEAMS_ENABLED=false
TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/YOUR/WEBHOOK/URL
TEAMS_SEVERITY_FILTER=CRITICAL,HIGH,MEDIUM,LOW

## Generic Webhook
WEBHOOK_ENABLED=false
WEBHOOK_URL=https://example.com/webhook
WEBHOOK_METHOD=POST
WEBHOOK_HEADERS={}
WEBHOOK_SEVERITY_FILTER=CRITICAL,HIGH,MEDIUM,LOW

## SMTP Email
SMTP_ENABLED=false
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USE_TLS=true
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM_ADDRESS=alerts@yourcompany.com
SMTP_FROM_NAME="Poirot DSPM"
SMTP_TO_ADDRESSES=security@yourcompany.com,admin@yourcompany.com
SMTP_SEVERITY_FILTER=CRITICAL,HIGH,MEDIUM,LOW

## TheHive (Case Management)
THEHIVE_ENABLED=false
THEHIVE_URL=http://thehive:9000
THEHIVE_API_KEY=your-api-key-here
THEHIVE_USER=api@poirot.local
THEHIVE_PASSWORD=your-password
THEHIVE_CREATE_CASES=true
THEHIVE_SEVERITY_FILTER=CRITICAL,HIGH,MEDIUM,LOW

# =============================================================================
# AI-POWERED REPORTS (Optional)
# =============================================================================

## Ollama
OLLAMA_ENABLED=false
OLLAMA_URL=http://host.docker.internal:11434
OLLAMA_MODEL=llama3.1:latest
OLLAMA_SEVERITY_FILTER=CRITICAL,HIGH,MEDIUM,LOW

# =============================================================================
# DATA SOURCES (.env is the single source of truth)
# Format: SOURCE_{TYPE}_{NAME}={"field":"value",...}
# The name segment uses underscores (e.g. POC_MYSQL → name "poc_mysql")
# =============================================================================

## MySQL example (connects to demo hawk-mysql container)
SOURCE_MYSQL_POC_MYSQL={"host":"hawk-mysql","port":3306,"user":"root","password":"rootpassword","database":"pocdb"}

## S3/LocalStack example (connects to demo localstack container)
SOURCE_S3_POC_BUCKET={"access_key":"test","secret_key":"test","bucket_name":"poc-bucket","endpoint_url":"http://localstack:4566"}

## S3 on AWS — explicit credentials
# SOURCE_S3_PROD={"bucket_name":"my-bucket","aws_region":"us-east-1","auth_method":"access_key","access_key":"AKIA...","secret_key":"..."}

## S3 on AWS — IAM Role (EC2/ECS/Lambda, no keys needed)
# SOURCE_S3_PROD={"bucket_name":"my-bucket","aws_region":"us-east-1","auth_method":"iam_role"}

## Kafka/Redpanda example (connects to demo redpanda container)
SOURCE_KAFKA_DEMO={"bootstrap_servers":"redpanda:9092","topics":"transactions,employee_data,app_logs","max_messages":"500","group_id":"poirot-scanner"}

## Kafka on AWS MSK — SASL/SCRAM
# SOURCE_KAFKA_MSK={"bootstrap_servers":"b-1.cluster.xxx.kafka.us-east-1.amazonaws.com:9096","topics":"my-topic","sasl_mechanism":"SCRAM-SHA-512","security_protocol":"SASL_SSL","username":"my-user","password":"my-pass"}

## Kafka on AWS MSK — IAM Auth (no username/password needed)
# SOURCE_KAFKA_MSK={"bootstrap_servers":"b-1.cluster.xxx.kafka.us-east-1.amazonaws.com:9098","topics":"my-topic","sasl_mechanism":"IAM","aws_region":"us-east-1"}

# =============================================================================
# SCHEDULER (Optional - for automatic scans)
# =============================================================================

SCHEDULER_ENABLED=false
SCHEDULER_INTERVAL_HOURS=24
