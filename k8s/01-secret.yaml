apiVersion: v1
kind: Secret
metadata:
  name: poirot-secret
  namespace: poirot
type: Opaque
# Use stringData for readability — Kubernetes will base64-encode automatically.
# To add a data source, add a SOURCE_TYPE_NAME entry and restart the pods.
# Changes here are the source of truth in K8s (not /app/.env).
stringData:

  # ── Notifications ────────────────────────────────────────────────────────────
  SLACK_ENABLED: "false"
  SLACK_WEBHOOK_URL: ""

  SMTP_ENABLED: "false"
  SMTP_HOST: "smtp.gmail.com"
  SMTP_PORT: "587"
  SMTP_USE_TLS: "true"
  SMTP_USERNAME: ""
  SMTP_PASSWORD: ""
  SMTP_FROM_ADDRESS: ""
  SMTP_FROM_NAME: "Poirot Security"
  SMTP_TO_ADDRESSES: ""
  SMTP_EMAIL_THEME: "dark_cyber"

  # ── TheHive ──────────────────────────────────────────────────────────────────
  THEHIVE_ENABLED: "false"
  THEHIVE_API_KEY: ""

  # ── Ollama AI ────────────────────────────────────────────────────────────────
  OLLAMA_ENABLED: "false"
  OLLAMA_URL: "http://ollama:11434"
  OLLAMA_MODEL: "llama3.2:3b"

  # ── Data Sources ─────────────────────────────────────────────────────────────
  # Uncomment / add entries for every source you want to scan.
  # Format: SOURCE_<TYPE>_<NAME>=<JSON config>
  #
  # SOURCE_KAFKA_DEMO: '{"bootstrap_servers":"redpanda:9092","topics":"transactions,employee_data,app_logs","max_messages":"500","group_id":"poirot-scanner"}'
  # SOURCE_MYSQL_PROD: '{"host":"db.example.com","port":3306,"user":"scanner","password":"s3cr3t","database":"prod"}'
  # SOURCE_S3_MAIN:    '{"access_key":"AKIA...","secret_key":"...","bucket_name":"my-bucket","region":"us-east-1"}'
  # SOURCE_ORACLE_DW:  '{"host":"oracle.example.com","port":1521,"user":"scanner","password":"s3cr3t","service_name":"ORCLPDB1"}'
